<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作品集 - 一拍一剪</title>
    <link rel="icon" href="./img/logo-正.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Roboto:wght@300;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css"> <!-- 使用跟主頁相同的 styles.css -->
</head>
<body>

    <!-- 導覽列（跟 index.html 完全一致） -->
    <nav class="navbar">
        <a href="index.html" class="logo">
            <img src="./img/logo.png" alt="一拍一剪 Logo" class="nav-logo">
        </a>

        <ul class="nav-links">
            <li><a href="index.html#首頁">首頁</a></li>
            <li><a href="index.html#關於我們">關於我們</a></li>
            <li><a href="index.html#最新公告">最新公告</a></li>
            <li><a href="#作品集">作品集</a></li> <!-- 當前頁高亮可加 class="active" -->
            <li><a href="index.html#聯絡我們">聯絡我們</a></li>
        </ul>

        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <div class="mobile-menu">
            <ul class="mobile-nav-links">
                <li><a href="index.html#首頁">首頁</a></li>
                <li><a href="index.html#關於我們">關於我們</a></li>
                <li><a href="index.html#最新公告">最新公告</a></li>
                <li><a href="#作品集">作品集</a></li>
                <li><a href="index.html#聯絡我們">聯絡我們</a></li>
            </ul>
        </div>
    </nav>

    <!-- 作品集主內容區 -->
    <section id="作品集" class="section portfolio-section">
        <h2>作品集</h2>

        <!-- Instagram 嵌入 -->
        <div class="social-embed instagram-embed">
            <script src="https://elfsightcdn.com/platform.js" async></script>
            <div class="elfsight-app-b96c83f2-5c3f-4ca0-a3bc-4bf5de7c42c3" data-elfsight-app-lazy></div>
        </div>

        <!-- YouTube 嵌入 -->
        <div class="social-embed youtube-embed">
            <script src="https://elfsightcdn.com/platform.js" async></script>
            <div class="elfsight-app-270f54ef-56e1-4231-ab4b-837902bf6af2" data-elfsight-app-lazy></div>
        </div>
    </section>

    <!-- JavaScript（漢堡選單功能） -->
    <script>
        const hamburger = document.querySelector('.hamburger');
        const mobileMenu = document.querySelector('.mobile-menu');

        if (hamburger && mobileMenu) {
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                mobileMenu.classList.toggle('active');
            });

            document.querySelectorAll('.mobile-nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    mobileMenu.classList.remove('active');
                });
            });
        }
    </script>

    <section id="custom-articles">
        <h2>自訂精選文章</h2>
        <div id="articles-container"></div>
    </section>

    <script>
        // 讀取所有文章並顯示（按日期排序，新到舊）
        async function loadArticles() {
            const response = await fetch('https://api.github.com/repos/20251p1ctw/1p1c/contents/articles');
            const files = await response.json();
            const articles = [];

            for (const file of files) {
                if (file.name.endsWith('.md')) {
                    const contentResp = await fetch(file.download_url);
                    const markdown = await contentResp.text();
                    // 簡單解析 front matter（標題、日期等）
                    const frontMatter = markdown.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
                    if (frontMatter) {
                        const yaml = frontMatter[1];
                        const body = frontMatter[2];
                        const title = yaml.match(/title: (.*)/)?.[1] || '';
                        const date = yaml.match(/date: (.*)/)?.[1] || '';
                        const image = yaml.match(/image: (.*)/)?.[1] || '';
                        const description = yaml.match(/description: (.*)/)?.[1] || '';

                        articles.push({ title, date, body, image, description });
                    }
                }
            }

            // 排序：新到舊
            articles.sort((a, b) => new Date(b.date) - new Date(a.date));

            // 顯示
            const container = document.getElementById('articles-container');
            container.innerHTML = articles.map(article => `
                <article style="margin-bottom: 40px; border-bottom: 1px solid #eee; padding-bottom: 20px;">
                    ${article.image ? `<img src="${article.image.startsWith('http') ? article.image : '/1p1c' + article.image}" alt="${article.title}" style="max-width:100%; border-radius:8px; margin-bottom:15px;">` : ''}
                    <h3>${article.title}</h3>
                    <p><small>${new Date(article.date).toLocaleDateString('zh-TW')}</small></p>
                    ${article.description ? `<p>${article.description}</p>` : ''}
                    <div>${marked.parse(article.body)}</div>  <!-- 需要 marked.js 解析 Markdown -->
                </article>
            `).join('');
        }

        loadArticles();

        // 加 marked.js 來解析 Markdown 成 HTML
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

</body>
</html>