<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作品集 - 一拍一剪</title>
    <link rel="icon" href="./img/logo-正.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Roboto:wght@300;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css"> <!-- 使用跟主頁相同的 styles.css -->
</head>
<body>

    <!-- 導覽列（跟 index.html 完全一致） -->
    <nav class="navbar">
        <a href="index.html" class="logo">
            <img src="./img/logo.png" alt="一拍一剪 Logo" class="nav-logo">
        </a>

        <ul class="nav-links">
            <li><a href="index.html#首頁">首頁</a></li>
            <li><a href="index.html#關於我們">關於我們</a></li>
            <li><a href="index.html#最新公告">最新公告</a></li>
            <li><a href="#作品集">作品集</a></li> <!-- 當前頁高亮可加 class="active" -->
            <li><a href="index.html#聯絡我們">聯絡我們</a></li>
        </ul>

        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <div class="mobile-menu">
            <ul class="mobile-nav-links">
                <li><a href="index.html#首頁">首頁</a></li>
                <li><a href="index.html#關於我們">關於我們</a></li>
                <li><a href="index.html#最新公告">最新公告</a></li>
                <li><a href="#作品集">作品集</a></li>
                <li><a href="index.html#聯絡我們">聯絡我們</a></li>
            </ul>
        </div>
    </nav>

    <!-- 作品集主內容區 -->
    <section id="作品集" class="section portfolio-section">
        <h2>作品集</h2>

        <!-- Instagram 嵌入 -->
        <div class="social-embed instagram-embed">
            <script src="https://elfsightcdn.com/platform.js" async></script>
            <div class="elfsight-app-b96c83f2-5c3f-4ca0-a3bc-4bf5de7c42c3" data-elfsight-app-lazy></div>
        </div>

        <!-- YouTube 嵌入 -->
        <div class="social-embed youtube-embed">
            <script src="https://elfsightcdn.com/platform.js" async></script>
            <div class="elfsight-app-270f54ef-56e1-4231-ab4b-837902bf6af2" data-elfsight-app-lazy></div>
        </div>
    </section>

    <!-- JavaScript（漢堡選單功能） -->
    <script>
        const hamburger = document.querySelector('.hamburger');
        const mobileMenu = document.querySelector('.mobile-menu');

        if (hamburger && mobileMenu) {
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                mobileMenu.classList.toggle('active');
            });

            document.querySelectorAll('.mobile-nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    mobileMenu.classList.remove('active');
                });
            });
        }
    </script>

    <!-- 自訂精選作品區（Decap CMS 管理） -->
    <section class="custom-works">
        <h2>精選作品</h2>
        <div class="works-grid" id="worksGrid">
            <p>載入中...</p>
        </div>
    </section>

    <script>
        // 從 /works 資料夾讀取所有 markdown 檔並顯示
        fetch('https://api.github.com/repos/20251p1ctw/1p1c/contents/works')
            .then(response => response.json())
            .then(files => {
                const grid = document.getElementById('worksGrid');
                grid.innerHTML = '';

                // 過濾只取 .md 檔
                const mdFiles = files.filter(file => file.name.endsWith('.md'));

                // 依日期排序（新→舊）
                mdFiles.sort((a, b) => b.name.localeCompare(a.name));

                if (mdFiles.length === 0) {
                    grid.innerHTML = '<p>目前尚無精選作品</p>';
                    return;
                }

                mdFiles.forEach(file => {
                    fetch(file.download_url)
                        .then(res => res.text())
                        .then(content => {
                            // 解析 YAML frontmatter
                            const frontmatter = content.match(/^---\n([\s\S]*?)\n---/);
                            if (!frontmatter) return;

                            const data = {};
                            frontmatter[1].split('\n').forEach(line => {
                                const [key, ...value] = line.split(': ');
                                if (key && value) data[key.trim()] = value.join(': ').replace(/"/g, '').trim();
                            });

                            const item = document.createElement('div');
                            item.className = 'work-item';
                            item.innerHTML = `
                                <img src="${data.image}" alt="${data.title}" loading="lazy">
                                <h3>${data.title}</h3>
                                <p>${data.description}</p>
                            `;
                            grid.appendChild(item);
                        });
                });
            })
            .catch(err => {
                document.getElementById('worksGrid').innerHTML = '<p>載入失敗，請稍後再試</p>';
            });
    </script>

</body>
</html>