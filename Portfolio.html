<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作品集 - 一拍一剪</title>
    <link rel="icon" href="./img/logo-正.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Roboto:wght@300;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles.css"> <!-- 使用跟主頁相同的 styles.css -->
</head>
<body>

    <!-- 導覽列（跟 index.html 完全一致） -->
    <nav class="navbar">
        <a href="index.html" class="logo">
            <img src="./img/logo.png" alt="一拍一剪 Logo" class="nav-logo">
        </a>

        <ul class="nav-links">
            <li><a href="index.html#首頁">首頁</a></li>
            <li><a href="index.html#關於我們">關於我們</a></li>
            <li><a href="index.html#最新公告">最新公告</a></li>
            <li><a href="index.html#作品集">作品集</a></li> <!-- 當前頁高亮可加 class="active" -->
            <li><a href="index.html#聯絡我們">聯絡我們</a></li>
        </ul>

        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <div class="mobile-menu">
            <ul class="mobile-nav-links">
                <li><a href="index.html#首頁">首頁</a></li>
                <li><a href="index.html#關於我們">關於我們</a></li>
                <li><a href="index.html#最新公告">最新公告</a></li>
                <li><a href="index.html#作品集">作品集</a></li>
                <li><a href="index.html#聯絡我們">聯絡我們</a></li>
            </ul>
        </div>
    </nav>

    <!-- 作品集主內容區 -->
    <section id="作品集" class="section portfolio-section">
        <h2>作品集</h2>

        <!-- Instagram 嵌入 -->
        <div class="social-embed instagram-embed">
            <script src="https://elfsightcdn.com/platform.js" async></script>
            <div class="elfsight-app-b96c83f2-5c3f-4ca0-a3bc-4bf5de7c42c3" data-elfsight-app-lazy></div>
        </div>

        <!-- YouTube 嵌入 -->
        <div class="social-embed youtube-embed">
            <script src="https://elfsightcdn.com/platform.js" async></script>
            <div class="elfsight-app-270f54ef-56e1-4231-ab4b-837902bf6af2" data-elfsight-app-lazy></div>
        </div>
    </section>

    <!-- JavaScript（漢堡選單功能） -->
    <script>
        const hamburger = document.querySelector('.hamburger');
        const mobileMenu = document.querySelector('.mobile-menu');

        if (hamburger && mobileMenu) {
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                mobileMenu.classList.toggle('active');
            });

            document.querySelectorAll('.mobile-nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    mobileMenu.classList.remove('active');
                });
            });
        }
    </script>

    <!-- 自訂文章區塊 -->
    <section id="custom-articles" class="section custom-works">
        <h2>自訂精選文章</h2>
        <div id="articles-container"></div>
    </section>

    <script>
        // 讀取所有文章並顯示（按日期排序，新到舊）
        async function loadArticles() {
            const container = document.getElementById('articles-container');  // ← 加上這行！
            if (!container) {
                console.error('找不到 #articles-container 元素');
                return;
            }

            const response = await fetch('https://api.github.com/repos/20251p1ctw/1p1c/contents/articles');
            const files = await response.json();
            const articles = [];

            for (const file of files) {
                if (file.name.endsWith('.md')) {
                    const contentResp = await fetch(file.download_url);
                    const markdown = await contentResp.text();
                    // 簡單解析 front matter（標題、日期等）
                    const frontMatter = markdown.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
                    if (frontMatter) {
                        const yaml = frontMatter[1];
                        const body = frontMatter[2];
                        const title = yaml.match(/title: (.*)/)?.[1]?.trim().replace(/^["']|["']$/g, '') || '無標題';
                        const date = yaml.match(/date: (.*)/)?.[1] || '';
                        const image = yaml.match(/image:\s*(.*)/)?.[1]?.trim().replace(/^["']|["']$/g, '') || '';
                        const description = yaml.match(/description: (.*)/)?.[1]?.trim().replace(/^["']|["']$/g, '') || '';

                        if (title) {  // 只有有標題的才加入
                            articles.push({ title, date, body, image, description });
                        }
                    }
                }
            }

            // 排序：新到舊
            articles.sort((a, b) => new Date(b.date) - new Date(a.date));

            // 顯示
            container.innerHTML = articles.map(article => `
                <article style="margin-bottom: 60px; padding: 20px; text-align: center; border-bottom: 1px solid #444;">
                    ${article.image ? `
                        <img src="${article.image.startsWith('http') ? article.image : '/1p1c' + article.image}" 
                            alt="${article.title}" 
                            style="max-width: 100%; height: auto; border-radius: 12px; margin: 0 auto 25px; display: block; box-shadow: 0 8px 25px rgba(0,0,0,0.4);">
                    ` : ''}
                    <h3 style="font-size: 16px; color: #8b5cf6; margin-bottom: 10px;">${article.title}</h3>
                    ${article.date ? `<p style="color:#aaa; margin-bottom: 20px;"><small>${new Date(article.date).toLocaleDateString('zh-TW')}</small></p>` : ''}
                    ${article.description ? `<p style="font-size:1.2em; color:#ddd; margin: 20px 0; max-width: 800px; margin-left: auto; margin-right: auto;">${article.description}</p>` : ''}
                    <div style="line-height:1.9; font-size:1.1em; color:#e0e0e0; max-width: 800px; margin: 0 auto; text-align: left;">
                        ${marked.parse(article.body)}
                    </div>
                </article>
            `).join('');

            if (articles.length === 0) {
                container.innerHTML = '<p style="text-align:center; color:#aaa;">目前沒有文章</p>';
            }
        }

        loadArticles();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

</body>
</html>